(()=>{"use strict";var t,e={254:(t,e,s)=>{var i=s(440),a=s.n(i),h=s(281);class n extends a().Scene{constructor(){super("PlayScene")}create(){const{height:t,width:e}=this.game.config;this.gameSpeed=15,this.isGameRunning=!1,this.respawnTime=0,this.score=0,this.energy=100,this.ironOverload=0,this.energyDecayRate=.009,this.ironIncreaseRate=10,this.ironDecreaseRate=15,this.lastObstacleX=0,this.lastBloodX=0,this.lastMedicineX=0,this.minObstacleGap=400,this.minBloodGap=500,this.minMedicineGap=800,this.minCrossTypeGap=200,this.lastObstacleSpawn=0,this.lastBloodSpawn=0,this.lastMedicineSpawn=0,this.jumpSound=this.sound.add("jump",{volume:.2}),this.hitSound=this.sound.add("hit",{volume:.2}),this.reachSound=this.sound.add("reach",{volume:.2}),this.startTrigger=this.physics.add.sprite(0,10).setOrigin(0,1).setImmovable(),this.sky=this.add.tileSprite(0,t-18,1,t+250,"sky").setOrigin(0,1),this.ground=this.add.tileSprite(0,t,88,26,"ground").setOrigin(0,1),this.boy=this.physics.add.sprite(0,t,"boy-idle").setCollideWorldBounds(!0).setGravityY(5e3).setBodySize(88,90).setDepth(1).setOrigin(0,1),this.scoreText=this.add.text(e,0,"00000",{fill:"#535353",font:"900 35px Courier",resolution:5}).setOrigin(1,0).setAlpha(0),this.highScoreText=this.add.text(0,0,"00000",{fill:"#535353",font:"900 35px Courier",resolution:5}).setOrigin(1,0).setAlpha(0),this.environment=this.add.group(),this.environment.addMultiple([this.add.image(e/2,170,"cloud"),this.add.image(e-80,80,"cloud"),this.add.image(e/1.3,100,"cloud")]),this.environment.setAlpha(0),this.gameOverScreen=this.add.container(e/2,t/2-50).setAlpha(0),this.gameStartScreen=this.add.container(e/2,t/2-50),this.gameOverText=this.add.image(0,0,"game-over"),this.gameTitleText=this.add.image(0,0,"title"),this.gameStartText=this.add.image(0,50,"start"),this.restart=this.add.image(0,80,"restart").setInteractive(),this.gameStartScreen.add([this.gameTitleText,this.gameStartText]),this.gameOverScreen.add([this.gameOverText,this.restart]),this.energy=100,this.energyBar=this.add.graphics(),this.obsticles=this.physics.add.group(),this.bloods=this.physics.add.group(),this.medicines=this.physics.add.group(),this.warningText=this.add.text(e/2,80,"IRON OVERLOADED",{font:"900 35px Courier",fill:"#FF0000",stroke:"#000000",strokeThickness:2,resolution:5}).setOrigin(.5).setAlpha(0);const s=new(a().Display.Color)(255,0,0),i=new(a().Display.Color)(255,165,0),h={value:0};this.tweens.add({targets:h,value:1,ease:"Sine.easeInOut",duration:750,yoyo:!0,repeat:-1,onUpdate:()=>{const t=h.value,e=a().Math.Interpolation.Linear([s.red,i.red],t),n=a().Math.Interpolation.Linear([s.green,i.green],t),o=a().Math.Interpolation.Linear([s.blue,i.blue],t),r="#"+new(a().Display.Color)(e,n,o).color.toString(16).padStart(6,"0").toUpperCase();this.warningText.setFill(r)}}),this.initAnims(),this.initStartTrigger(),this.initColliders(),this.handleInputs(),this.handleScore()}updateEnergyBar(){const{width:t}=this.game.config,e=200,s=t/2-100;this.energyBar.clear(),this.energyBar.fillStyle(3355443),this.energyBar.fillRect(s,30,e,20);let i=65280;this.energy>100?(i=16711680,this.warningText.setAlpha(1)):this.energy<30?(i=16753920,this.warningText.setAlpha(0)):(i=65280,this.warningText.setAlpha(0)),0==this.energy&&this.gameOver();const h=a().Math.Clamp(this.energy,0,100);this.energyBar.fillStyle(i),this.energyBar.fillRect(s,30,h/100*e,20),this.energyBar.lineStyle(2,16777215),this.energyBar.strokeRect(s,30,e,20)}gameOver(){this.highScoreText.x=this.scoreText.x-this.scoreText.width-20;const t=this.highScoreText.text.substr(this.highScoreText.text.length-5),e=Number(this.scoreText.text)>Number(t)?this.scoreText.text:t;this.highScoreText.setText("HI "+e),this.highScoreText.setAlpha(1),this.physics.pause(),this.isGameRunning=!1,this.anims.pauseAll(),this.boy.setTexture("boy-hurt"),this.respawnTime=0,this.gameSpeed=5,this.gameOverScreen.setAlpha(1),this.score=0,this.energy=100,this.hitSound.play()}initColliders(){this.physics.add.collider(this.boy,this.obsticles,()=>{this.gameOver()},null,this),this.physics.add.overlap(this.boy,this.bloods,(t,e)=>{e.destroy(),this.energy+=30,this.updateEnergyBar()}),this.physics.add.overlap(this.boy,this.medicines,(t,e)=>{e.destroy(),this.energy>100&&(this.energy=100),this.updateEnergyBar()})}initStartTrigger(){const{width:t,height:e}=this.game.config;this.physics.add.overlap(this.startTrigger,this.boy,()=>{if(10===this.startTrigger.y)return void this.startTrigger.body.reset(0,e);this.startTrigger.disableBody(!0,!0);const s=this.time.addEvent({delay:1e3/60,loop:!0,callbackScope:this,callback:()=>{this.gameStartScreen.setAlpha(0),this.boy.setVelocityX(80),this.boy.play("boy-run",1),this.ground.width<t&&(this.ground.width+=34,this.sky.width+=34),this.ground.width>=1e3&&(this.ground.width=t,this.sky.width=t,this.isGameRunning=!0,this.updateEnergyBar(),this.boy.setVelocityX(0),this.scoreText.setAlpha(1),this.environment.setAlpha(1),this.warningText.setAlpha(0),s.remove())}})},null,this)}initAnims(){this.anims.create({key:"boy-run",frames:this.anims.generateFrameNumbers("boy",{start:0,end:1}),frameRate:8,repeat:-1})}handleScore(){this.time.addEvent({delay:100,loop:!0,callbackScope:this,callback:()=>{if(!this.isGameRunning)return;this.score++,this.gameSpeed+=.01,this.score%100==0&&(this.reachSound.play(),this.tweens.add({targets:this.scoreText,duration:100,repeat:3,alpha:0,yoyo:!0}));const t=Array.from(String(this.score),Number);for(let e=0;e<5-String(this.score).length;e++)t.unshift(0);this.scoreText.setText(t.join(""))}})}restartGame(){this.boy.setVelocityY(0),this.boy.body.height=92,this.boy.body.offset.y=0,this.physics.resume(),this.obsticles.clear(!0,!0),this.bloods.clear(!0,!0),this.medicines.clear(!0,!0),this.isGameRunning=!0,this.gameOverScreen.setAlpha(0),this.anims.resumeAll(),this.lastObstacleX=0,this.lastBloodX=0,this.lastMedicineX=0,this.lastObstacleSpawn=0,this.lastBloodSpawn=0,this.lastMedicineSpawn=0}handleInputs(){this.restart.on("pointerdown",()=>{this.restartGame()}),this.input.keyboard.on("keydown",()=>{this.isGameRunning||1!==this.gameOverScreen.alpha||this.restartGame()}),this.input.keyboard.on("keydown-SPACE",()=>{!this.boy.body.onFloor()||this.boy.body.velocity.x>0||(this.jumpSound.play(),this.boy.body.height=92,this.boy.body.offset.y=0,this.boy.setVelocityY(-1600))}),this.input.keyboard.on("keydown-DOWN",()=>{this.boy.body.onFloor()&&this.isGameRunning&&(this.boy.body.height=58,this.boy.body.offset.y=34)}),this.input.keyboard.on("keyup-DOWN",()=>{(0===this.score||this.isGameRunning)&&(this.boy.body.height=92,this.boy.body.offset.y=0)}),this.input.on("pointerdown",()=>{this.isGameRunning||1!==this.gameOverScreen.alpha||this.restartGame(),this.boy.body.onFloor()&&(this.jumpSound.play(),this.boy.body.height=92,this.boy.body.offset.y=0,this.boy.setVelocityY(-1600))})}canSpawnAt(t,e=null){const s=this.minCrossTypeGap,i=[this.obsticles,this.bloods,this.medicines];for(let a of i){if(a===e)continue;const i=a.getChildren();for(let e of i)if(e.active){if(Math.abs(e.x-t)<s)return!1}}return!0}placeObsticle(){const t=Math.floor(7*Math.random())+1,e=a().Math.Between(600,900);let s,i=this.game.config.width+e;if(this.lastObstacleX>0){const t=this.lastObstacleX+this.minObstacleGap;i=Math.max(i,t)}this.canSpawnAt(i,this.obsticles)||(i+=this.minCrossTypeGap),t>4||(s=this.obsticles.create(i,this.game.config.height-18,`obsticle-${t}`).setOrigin(0,1),s.body.offset.y=10,s.setImmovable()),this.lastObstacleX=i}placeBlood(){if(a().Math.Between(0,100)>70)return;const t=a().Math.Between(600,1200);let e=this.game.config.width+t;if(this.lastBloodX>0){const t=this.lastBloodX+this.minBloodGap;e=Math.max(e,t)}this.canSpawnAt(e,this.bloods)||(e+=this.minCrossTypeGap);const s=this.bloods.create(e,this.game.config.height-30,"blood").setOrigin(0,1);s.setImmovable(),s.body.setAllowGravity(!1),this.lastBloodX=e}placeMedicine(){if(a().Math.Between(0,100)>80)return;const t=a().Math.Between(1500,2500);let e=this.game.config.width+t;if(this.lastMedicineX>0){const t=this.lastMedicineX+this.minMedicineGap;e=Math.max(e,t)}this.canSpawnAt(e,this.medicines)||(e+=this.minCrossTypeGap);const s=this.medicines.create(e,this.game.config.height-20,"meds").setOrigin(0,1);s.setImmovable(),s.body.setAllowGravity(!1),this.lastMedicineX=e}update(t,e){if(!this.isGameRunning)return;this.ground.tilePositionX+=this.gameSpeed,a().Actions.IncX(this.obsticles.getChildren(),-this.gameSpeed),a().Actions.IncX(this.bloods.getChildren(),-this.gameSpeed),a().Actions.IncX(this.medicines.getChildren(),-this.gameSpeed),a().Actions.IncX(this.environment.getChildren(),-.5),this.energy-=e*this.energyDecayRate,this.energy=a().Math.Clamp(this.energy,0,120),this.updateEnergyBar(),this.energy<20?this.gameSpeed=9.5:this.energy<40?this.gameSpeed=10.5:this.energy>100?this.gameSpeed=12:this.gameSpeed=15;const{width:s}=this.game.config,i=this.gameSpeed*e*.08;this.lastObstacleSpawn+=i,this.lastBloodSpawn+=i,this.lastMedicineSpawn+=i,this.lastObstacleSpawn>a().Math.Between(1e3,1400)&&(this.placeObsticle(),this.lastObstacleSpawn=0),this.lastBloodSpawn>a().Math.Between(1200,2e3)&&(this.placeBlood(),this.lastBloodSpawn=0),this.lastMedicineSpawn>a().Math.Between(2800,3800)&&(this.placeMedicine(),this.lastMedicineSpawn=0),this.obsticles.getChildren().forEach(t=>{t.getBounds().right<0&&this.obsticles.killAndHide(t)}),this.bloods.getChildren().forEach(t=>{t.getBounds().right<0&&this.bloods.killAndHide(t)}),this.medicines.getChildren().forEach(t=>{t.getBounds().right<0&&this.medicines.killAndHide(t)}),this.environment.getChildren().forEach(t=>{t.getBounds().right<0&&(t.x=this.game.config.width+30)}),this.boy.play("boy-run",1)}}const o=n;class r extends a().Scene{constructor(){super("PreloadScene")}preload(){this.load.font("8bit","assets/8-bit-hud.ttf"),this.load.audio("jump","assets/jump.m4a"),this.load.audio("hit","assets/hit.m4a"),this.load.audio("reach","assets/reach.m4a"),this.load.image("title","assets/title.png"),this.load.image("start","assets/start.png"),this.load.image("ground","assets/ground.png"),this.load.image("overloaded","assets/overloaded.png"),this.load.image("boy-idle","assets/boy-idle.png"),this.load.image("boy-hurt","assets/boy-hurt.png"),this.load.image("restart","assets/restart.png"),this.load.image("game-over","assets/game-over.png"),this.load.image("cloud","assets/cloud.png"),this.load.image("sky","assets/sky.png"),this.load.image("blood","assets/blood_droplet.png"),this.load.image("meds","assets/medicine.png"),this.load.spritesheet("boy","assets/boy-run.png",{frameWidth:90,frameHeight:90}),this.load.spritesheet("enemy-bird","assets/enemy-bird.png",{frameWidth:92,frameHeight:77}),this.load.image("obsticle-1","assets/obstacles-1.png"),this.load.image("obsticle-2","assets/obstacles-2.png"),this.load.image("obsticle-3","assets/obstacles-3.png"),this.load.image("obsticle-4","assets/obstacles-4.png")}create(){this.scene.start("PlayScene")}}const l=r,d={type:a().AUTO,parent:"game-container",height:340,pixelArt:!0,transparent:!0,physics:{default:"arcade",arcade:{debug:!1}},plugins:{global:[{key:"FontPlugin",plugin:h.F,start:!0}]},scene:[l,o]};window.addEventListener("load",()=>{console.log("Starting Phaser game..."),new(a().Game)(d)})}},s={};function i(t){var a=s[t];if(void 0!==a)return a.exports;var h=s[t]={exports:{}};return e[t].call(h.exports,h,h.exports,i),h.exports}i.m=e,t=[],i.O=(e,s,a,h)=>{if(!s){var n=1/0;for(d=0;d<t.length;d++){for(var[s,a,h]=t[d],o=!0,r=0;r<s.length;r++)(!1&h||n>=h)&&Object.keys(i.O).every(t=>i.O[t](s[r]))?s.splice(r--,1):(o=!1,h<n&&(n=h));if(o){t.splice(d--,1);var l=a();void 0!==l&&(e=l)}}return e}h=h||0;for(var d=t.length;d>0&&t[d-1][2]>h;d--)t[d]=t[d-1];t[d]=[s,a,h]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={524:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var a,h,[n,o,r]=s,l=0;if(n.some(e=>0!==t[e])){for(a in o)i.o(o,a)&&(i.m[a]=o[a]);if(r)var d=r(i)}for(e&&e(s);l<n.length;l++)h=n[l],i.o(t,h)&&t[h]&&t[h][0](),t[h]=0;return i.O(d)},s=self.webpackChunkthalassemia_run=self.webpackChunkthalassemia_run||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var a=i.O(void 0,[121],()=>i(254));a=i.O(a)})();